<?xml version="1.0" encoding="UTF-8"?><databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">	<changeSet id="events_1" author="zhangwenyun">	<sql>		DROP EVENT IF EXISTS GENERATE_TOP_ACTIVE;	</sql>	<sql>		DROP EVENT IF EXISTS GENERATE_TOP_INCOME;	</sql>	<sql>		DROP EVENT IF EXISTS GENERATE_TOP_WEALTH;	</sql>	<sql>		DROP EVENT IF EXISTS GENERATE_TOP_LEVEL;	</sql>	<sql>		DROP EVENT IF EXISTS DELETE_INVALID_CODE;	</sql>		<createProcedure >			CREATE EVENT GENERATE_TOP_ACTIVE ON SCHEDULE EVERY 30 MINUTE ON COMPLETION			NOT PRESERVE ENABLE DO begin			TRUNCATE TABLE ec_top_active;			insert into ec_top_active select			u.id,u.mobileNumber,u.nickName,count(*),now()			from ec_user u,ec_login_log g			where u.id = g.userid and u.status = 1 and u.mobileNumber != '13951885586' group by g.userid order by count(*) desc ,u.createTime  limit 0,100;			end;		</createProcedure>		<createProcedure >						CREATE EVENT GENERATE_TOP_INCOME ON SCHEDULE EVERY 30 MINUTE ON COMPLETION			NOT PRESERVE ENABLE DO begin			TRUNCATE TABLE ec_top_income;			insert into ec_top_income			select b.id,b.mobileNumber,b.nickName,b.amount ,now() from (				select u.id,u.mobileNumber,u.nickName,sum(d.amount) as amount ,u.createTime					from ec_user u,ec_deal_detail d						where u.id = d.userid and d.detailType = 2 and d.status = 0  and u.status = 1 and u.mobileNumber != '13951885586' group by d.userid ) b 				where b.amount > 0 order by b.amount desc,b.createTime limit 0,100;			end;		</createProcedure>		<createProcedure >						CREATE EVENT GENERATE_TOP_WEALTH ON SCHEDULE EVERY 30 MINUTE ON COMPLETION			NOT PRESERVE ENABLE DO begin			TRUNCATE TABLE ec_top_wealth;			insert into ec_top_wealth			select u.id,u.mobileNumber,u.nickName,w.amount ,now() from ec_user u ,			ec_user_wallet w where u.id = w.userid and u.status = 1 and w.amount > 0 and u.mobileNumber != '13951885586' order by w.amount desc,u.createTime limit			0, 100;			end;					</createProcedure>		<createProcedure >			CREATE EVENT GENERATE_TOP_LEVEL ON SCHEDULE EVERY 30 MINUTE ON COMPLETION			NOT PRESERVE ENABLE DO begin			TRUNCATE TABLE ec_top_level;			insert into ec_top_level			select u.id,u.mobileNumber,u.nickName,u.level ,now() from ec_user u where u.status = 1 and u.mobileNumber != '13951885586' 			order by u.level desc,u.createTime limit 0,100;			end;		</createProcedure>		<createProcedure >		<![CDATA[ 			CREATE EVENT DELETE_INVALID_CODE ON SCHEDULE EVERY 1 MINUTE ON COMPLETION			NOT PRESERVE ENABLE DO begin			delete from ec_validate_code where invalidTime < now();			end;			]]>		</createProcedure>	</changeSet></databaseChangeLog>