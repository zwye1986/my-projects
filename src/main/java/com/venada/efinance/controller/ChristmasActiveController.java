package com.venada.efinance.controller;import com.venada.efinance.business.PrizeBusiness;import com.venada.efinance.common.controller.BaseController;import com.venada.efinance.pojo.ChristmasActive;import com.venada.efinance.pojo.ChristmasActiveInvite;import com.venada.efinance.pojo.PrizeDetail;import com.venada.efinance.service.ChristmasActiveInviteService;import com.venada.efinance.service.ChristmasActiveService;import com.venada.efinance.util.DateUtils;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;import javax.servlet.http.HttpServletRequest;import java.util.ArrayList;import java.util.HashMap;import java.util.List;import java.util.Map;@Controllerpublic class ChristmasActiveController extends BaseController{		@Autowired	private ChristmasActiveService christmasActiveImpl;	@Autowired	private ChristmasActiveInviteService christmasActiveInviteImpl;	@Autowired	private  PrizeBusiness prizeBusinessImpl;		@RequestMapping(value="christmasActiveIndex.html")	public String christmasActiveIndex(){		return "/christmasActive/index";	}		@RequestMapping(value="/christmasActive.html")	@ResponseBody	public Map<String,Object> getChristmasActive(Model model,HttpServletRequest request){		Map<String,Object> condition = new HashMap<String,Object>() ;		String startTime=DateUtils.getDayStart(0);		String endTime=DateUtils.getDayEnd(0);		String searchTime=request.getParameter("searchTime");		if((searchTime!=null)&&(!searchTime.equals(""))){			startTime=searchTime+" 00:00:00";			endTime=searchTime+" 23:59:59";		}		Map<String,Object> result = new HashMap<String,Object>() ;		condition.put("startIndex", 0);		condition.put("endIndex", 10);		condition.put("startTime", startTime);		condition.put("endTime", endTime);		List<ChristmasActive> res =new ArrayList<ChristmasActive>();		res =  christmasActiveImpl.findObjects("selectTopChristmasActive", condition);		result.put("data", res);      return result;	}		@RequestMapping(value="/christmasActiveInvite.html")	@ResponseBody	public Map<String,Object> getChristmasActiveInvite(Model model){		Map<String,Integer> limit = new HashMap<String,Integer>() ;		Map<String,Object> result = new HashMap<String,Object>() ;		limit.put("startIndex", 0);		limit.put("endIndex", 5);		List<ChristmasActiveInvite> res =new ArrayList<ChristmasActiveInvite>();		res=  christmasActiveInviteImpl.findObjects("selectTopChristmasActiveInvite", limit);		result.put("data", res);		return result;	}	@RequestMapping(value="/getActiveTime" )	@ResponseBody		public String getActiveTime(String format){		//1 活动尚未开始 2 活动已经结束		String now="1";		if(DateUtils.compareCurrentDate("2013-12-25 00:00:00")){						if(DateUtils.compareCurrentDate("2014-01-02 00:00:00")){				now="2";			}else{				now=DateUtils.toString(DateUtils.getCurDate(),format);			}		}		return now;	}			@RequestMapping(value="/getActiveTimeTask")	@ResponseBody		public String getActiveTimeTask(String format){		String now="2013-12-25";		if(DateUtils.compareCurrentDate("2013-12-25 00:00:00")){						if(DateUtils.compareCurrentDate("2014-01-02 00:00:00")){				now="2014-01-01";			}else{				now=DateUtils.toString(DateUtils.getCurDate(),format);			}		}		return now;	}		@RequestMapping(value = "/getPrizeTask.html")	@ResponseBody	public Map<String, Object> getPrizeTask(HttpServletRequest request) {		Map<String, Object> result = new HashMap<String, Object>();		result.clear();		Map<String, Object> condition = new HashMap<String, Object>();		List<String> dotype = new ArrayList<String>();		dotype.add("2");// 查询每天领取游戏最多的用户		dotype.add("3");// 查询每天第二名到第10名的随机用户		condition.put("createTime", DateUtils.getDayStart(0));		condition.put("dotype", dotype);		List<PrizeDetail> prizelist =new ArrayList<PrizeDetail>();		prizelist=	prizeBusinessImpl.getPrizeDetailByType(condition);		result.put("data", prizelist);		return result;	}			@RequestMapping(value="/getPrizeInvite.html")	@ResponseBody	public Map<String,Object>getPrizeInviteUser(HttpServletRequest request){		Map<String, Object> result = new HashMap<String, Object>();		if (DateUtils.compareCurrentDate("2014-01-02 01:00:00")) {			Map<String,Object> doTypeInvitecondition = new HashMap<String,Object>() ;			List<String> dotype = new ArrayList<String>();			dotype.add("4");//  查询每天领任务第一名			doTypeInvitecondition.put("dotype",dotype);			List<PrizeDetail> prizelist =new ArrayList<PrizeDetail>();			 prizelist = prizeBusinessImpl					.getPrizeDetailByType(doTypeInvitecondition);			result.put("data", prizelist);		} else {			//1 推荐获将在2014-01-02揭晓			result.put("msg", "1"); 		}		return result ;	}		}