<%@ page language="java" pageEncoding="UTF-8"%><%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%><%@taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%><c:set var="ctx" value="${pageContext.request.contextPath }"	scope="request"></c:set><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>积分兑换管理</title><link href="${ctx }/css/manager/main.css" rel="stylesheet" /><link rel="stylesheet" href="${ctx }/css/jquery_maklon_tools.css" /><link href="${ctx }/css/jquery.msgbox.css" rel="stylesheet"	type="text/css" /><link href="${ctx }/css/tc1.css" rel="stylesheet" type="text/css" /><link rel="stylesheet" href="${ctx }/css/zTreeStyle.css" type="text/css"><script type="text/javascript" src="${ctx }/js/jquery-1.4.4.min.js"></script><script type="text/javascript" src="${ctx }/js/jquery.maklon.tools.js"></script><script type="text/javascript" src="${ctx }/js/jquery.msgbox.js"></script><script type="text/javascript" src="${ctx }/js/jquery.ztree.core-3.5.js"></script><script type="text/javascript"	src="${ctx }/js/jquery.ztree.excheck-3.5.js"></script><script type="text/javascript"	src="${ctx}/js/jquery-ui-1.10.3.custom.min.js"></script><link href="${ctx }/css/jquery-ui-1.10.3.custom.min.css"	rel="stylesheet" /><style type="text/css"><!--body {	margin-left: 3px;	margin-top: 0px;	margin-right: 3px;	margin-bottom: 0px;	background-color: #f1f1f2;	color: #5c5c5c;}.cx {	width: 59px;	height: 22px;	background: url(${ctx}/images/admin/cx_btn.png) no-repeat;	cursor: pointer;	border: none;	color: #fff;}.selected td {	background: #e1f6f1;}em {	font-style: normal;	color: #fff;}.txt {	color: #fff;}.STYLE1 {	color: #fff;	font-size: 16px;}.STYLE6 {	color: #000000;	font-size: 12;}.STYLE10 {	color: #000000;	font-size: 12px;}.STYLE19 {	color: #344b50;	font-size: 12px;}.STYLE21 {	font-size: 12px;	color: #3b6375;	position: relative;}.STYLE22 {	font-size: 12px;	color: #295568;}.id,.phone,.user {	width: 45%;	height: 22px;}.date {	height: 22px;	width: 25%;}.money {	height: 22px;	width: 15%;}#btn {	width: 86px;	height: 31px;	background: url(images/search_btn.png) no-repeat;	border: none;	cursor: pointer;	margin-left: 5px;}.chao_z_btn input {	background: #4797f1;	color: #fff;	width: 59px;	height: 22px;	border: none;	margin-right: 5px;	cursor: pointer;}.chao_z_btn input:hover {	background: #3b3a3f;}--></style><script type="text/javascript">$(document).ready(function(){		$("#close").click(function(){		$("#tck").hide();	});	 	 $("#sb").click(function(){		 $("input[name='currentPage']").val(1);		 $("#mainForm").attr("method","post").submit();	 });	 	 $("#save").click(function(){		 $.ajax({			   type: "POST",			   async: false,			   cache: false,			   dataType: "json",			   data:{id:$("#id").val(),status:$("#selectstauts").val()},			   url: "${ctx}/manager/creditsManagerByJson/toUpdate",			   success: function(data){				   alert(data.msg);				   window.location.href="${ctx}/manager/convertCreditsList.html";				  }			});	 });	 	 var date1 = $("#actionStartTime").val();	 var date2 = $("#actionEndTime").val();	    	    		$("#actionStartTime").datepicker({				changeMonth : true,				changeYear : true			});			$("#actionStartTime").datepicker("option", "dateFormat", "yy-mm-dd");			$("#actionEndTime").datepicker({				changeMonth : true,				changeYear : true			});			$("#actionEndTime").datepicker("option", "dateFormat", "yy-mm-dd");			$("#actionStartTime").val(date1);						$("#actionEndTime").val(date2);	 	 $("#data tbody tr").hover(			  function(){			   $(this).addClass('selected');			  },			  function() 			  {			   $(this).removeClass('selected');			  }			 );		});	function onPageSizeChange(value){	document.getElementById("page.pageSize").value=value;	document.all.mainForm.submit();}//分页验证function paginate(forward){	if(forward)	{		document.getElementById("page.currentPage").value=forward;	}else{		var temp=document.getElementById("forwardPage").value;				if(temp=="")		{			top.jQuery.alerts.alert('输入的页数为空。','提示');			return false;		}    	var reg = /^[0-9]\d*$/;    	if(!reg.test(temp)) {    		top.jQuery.alerts.alert('输入的页数必须为数字。','提示');    		return false;    	}     	if( temp < 1 || temp > parseInt('${page.totalPages}'))    	{    		top.jQuery.alerts.alert('输入的页数超过了显示的范围。','提示');    		return false;    	}		document.getElementById("page.currentPage").value=document.getElementById("forwardPage").value;	}	document.mainForm.submit();}		function showDetail(id) {			$("#tck").show();			$.ajax({				   type: "POST",				   async: false,				   cache: false,				   dataType: "json",				   data:{id:id},				   url: "${ctx}/manager/creditsManagerByJson/showDetailByJson",				   success: function(data){					    $("#creditsGoodsName").val(data.creditsGoodsName);					    $("#num").val(data.num);					    $("#expendCredits").val(data.expendCredits);					    $("#actionTime").val(data.actionTime);					    $("#name").val(data.username);					    $("#umobileNumber").val(data.umobileNumber);					    if(data.mobileNumber.length==11){					    	$("#rmoblie").show();					    	$("#mobileNumber").val(data.mobileNumber);					    }else{					    	$("#rmoblie").hide();					    	$("#mobileNumber").val(data.mobileNumber);					    }					    $("#remark").val(data.remark);					    $("#selectstauts").val(data.status);					    $("#id").val(data.id);					  }				});						}				function modifyDetail(id) {			/* $.showPanel("修改积分兑换明细",					"${ctx }/manager/credits/toUpdate?id="+id,					700, 500, true, "${ctx}"); */					   window.location.href="${ctx}/manager/creditsManager/"+id+"/toUpdate";			return;	}		</script></head><body style="padding: 25px;">	<form action="${ctx }/manager/convertCreditsList" method="get"		target="_self" id="mainForm" name="mainForm">		<table width="100%" border="0" align="center" cellpadding="0"			cellspacing="0">			<tr>				<td height="30"><table width="100%" border="0" cellspacing="0"						cellpadding="0">						<tr>							<td height="62" bgcolor="#3b3a3f"								style="border-bottom: 1px solid #d5d1c8; border-top: 1px solid #d5d1c8; padding: 0 20px;"><table									width="100%" border="0" cellspacing="0" cellpadding="0">									<tr>										<td height="39"><table width="100%" border="0"												cellspacing="0" cellpadding="0">											</table></td>										<td><label class="txt">手机号码：</label> <input class="phone"											type="text" name="$.mobilePhone" id="mobilePhone"											value="${condition.mobilePhone}"></td>										<td><label class="txt">状态</label> <select name="$.status"											id="status">												<option value="">全部</option>												<option value="0"													<c:if test="${condition.status eq 0 }">selected = "selected"</c:if>>兑换成功</option>												<option value="1"													<c:if test="${condition.status eq 1 }">selected = "selected"</c:if>>邮递中</option>												<option value="2"													<c:if test="${condition.status eq 2 }">selected = "selected"</c:if>>发货成功</option>												<option value="3"													<c:if test="${condition.status eq 3 }">selected = "selected"</c:if>>退货成功</option>										</select></td>										<td width="300"><div align="center"												style="height: 32px; line-height: 32px;">												<span class="STYLE1"> <em>兑换时间：</em> <input													class="date" size="3" type="text" name="$.actionStartTime"													id="actionStartTime" value="${condition.actionStartTime}" />－<input													type="text" class="date" name="$.actionEndTime"													id="actionEndTime" size="3"													value="${condition.actionEndTime}" />												</span>											</div></td>										<td><input type="button" value="查询" class="cx" id="sb" /></td>									</tr>								</table></td>						</tr>					</table></td>			</tr>			<tr>				<td height="10"></td>			</tr>			<tr>				<td><table id="data" width="100%" border="0" cellpadding="0"						cellspacing="1" bgcolor="#e2e2e2">						<tr>							<input type="hidden" name="pageSize" id="page.pageSize"								value="${page.pageSize }" />							<input type="hidden" name="currentPage" id="page.currentPage"								value="${page.currentPage }" />							<td width="3%" height="46" bgcolor="e5e6e6" class="STYLE10"><div									align="center">序号</div></td>							<td width="10%" height="40" bgcolor="e5e6e6" class="STYLE6"><div									align="center">									<span class="STYLE10">客户姓名</span>								</div></td>							<td width="6%" height="40" bgcolor="e5e6e6" class="STYLE6"><div									align="center">									<span class="STYLE10">手机号码</span>								</div></td>							<td width="7%" height="40" bgcolor="e5e6e6" class="STYLE6"><div									align="center">									<span class="STYLE10">数量</span>								</div></td>							<td width="10%" height="40" bgcolor="e5e6e6" class="STYLE6"><div									align="center">									<span class="STYLE10">商品名称</span>								</div></td>							<td width="10%" height="40" bgcolor="e5e6e6" class="STYLE6"><div									align="center">									<span class="STYLE10">充值手机号码</span>								</div></td>							<td width="10%" height="40" bgcolor="e5e6e6" class="STYLE6"><div									align="center">									<span class="STYLE10">兑换积分</span>								</div></td>							<td width="10%" height="40" bgcolor="e5e6e6" class="STYLE6"><div									align="center">									<span class="STYLE10">兑换时间</span>								</div></td>							<td width="10%" height="40" bgcolor="e5e6e6" class="STYLE6"><div									align="center">									<span class="STYLE10">发货状态</span>								</div></td>							<td width="20%" height="40" bgcolor="e5e6e6" class="STYLE6"><div									align="center">									<span class="STYLE10">操作</span>								</div></td>						</tr>						<tbody>							<c:forEach items="${convertCreditsList }" var="item"								varStatus="s" begin="0">								<tr>									<td height="40" bgcolor="#FFFFFF"><div align="center">											${(page.currentPage-1)*page.pageSize+(s.index+1) }</div></td>									<td height="40" bgcolor="#FFFFFF" class="STYLE19"><div											align="center">${item.user.name}</div></td>									<td height="40" bgcolor="#FFFFFF" class="STYLE19"><div											align="center">${item.user.mobileNumber}</div></td>									<td height="40" bgcolor="#FFFFFF" class="STYLE21"><div											align="center">${item.num}</div></td>									<td height="40" bgcolor="#FFFFFF" class="STYLE19"><div											align="center">${item.creditsGoodsName}</div></td>									<td height="40" bgcolor="#FFFFFF" class="STYLE19"><div											align="center">${item.mobileNumber}</div></td>									<td height="40" bgcolor="#FFFFFF"><div align="center"											class="STYLE19">${item.expendCredits}</div></td>									<td height="40" bgcolor="#FFFFFF" class="STYLE19"><div											align="center">											<fmt:formatDate value="${item.actionTime }"												pattern="yyyy-MM-dd HH:mm:ss" />										</div></td>									<td height="40" bgcolor="#FFFFFF" class="STYLE19"><div											align="center">											<c:choose>												<c:when test="${item.status eq 0 }">兑换成功</c:when>												<c:when test="${item.status eq 1}">邮寄中</c:when>												<c:when test="${item.status eq 2}">发货成功</c:when>												<c:when test="${item.status eq 3}">退货成功</c:when>												<c:otherwise></c:otherwise>											</c:choose>										</div></td>									<td height="40" bgcolor="#FFFFFF" class="STYLE21">										<div align="center" class="chao_z_btn">											<input type="button" onclick="showDetail('${item.id}')"												value="查看"> <input type="button" value="修改"												onclick="modifyDetail('${item.id}')">										</div>									</td>								</tr>							</c:forEach>						</tbody>						<tr bgcolor="#FFFFFF">							<td colspan="10" height="30"><%@include									file="../../PaginationMore.inc"%></td>						</tr>					</table>					<table width="100%" style="line-height: 48px;">						<tr>							<td align="center" style="color: #666;">苏ICP备13017605号								2013江苏维纳达软件技术有限公司</td>						</tr>					</table>					<div class="tck" id="tck" style="display: none">						<p class="tck_t">							<label class="tck_xx">详细内容</label> <em class="del"></em>						</p>						<form>							<div class="kv_item">								<label class="news_add_list">商品名称:</label><input type="text" id="creditsGoodsName" readonly="readonly"									class="news_txt">							</div>							<div class="kv_item">								<label class="news_add_list">数量:</label><input type="text"  id="num" readonly="readonly"									class="news_txt">							</div>							<div class="kv_item">								<label class="news_add_list">兑换积分:</label><input type="text"  id="expendCredits" readonly="readonly"									class="news_txt">							</div>							<div class="kv_item">								<label class="news_add_list">兑换时间:</label><input type="text"  id="actionTime" readonly="readonly"									class="news_txt">							</div>							<div class="kv_item">								<label class="news_add_list">客户名称:</label><input type="text"  id="name" readonly="readonly"									class="news_txt">							</div>							<div class="kv_item">								<label class="news_add_list">用户帐号:</label><input type="text"  id="umobileNumber" readonly="readonly"									class="news_txt">							</div>							<div class="kv_item" id="rmoblie" style="display:none;">								<label class="news_add_list">充值手机号码:</label><input type="text"  id="mobileNumber" readonly="readonly"									class="news_txt">							</div>							<div class="kv_item">								<label class="news_add_list">发货状态:</label>								<select id="selectstauts">								        <option value="0">兑换成功</option>										<option value="1">邮寄中</option>										<option value="2">发货成功</option>										<option value="3">退货成功</option>								</select>							</div>							<div class="kv_item">								<label class="news_add_list">备注:</label><input type="text"  id="remark" readonly="readonly"									class="news_txt">									<input type="hidden"  id="id" class="news_txt">							</div>							<div class="btn">								<span  id="close">关闭</span> <span id="save">保存</span>							</div>						</form>					</div></body></html>