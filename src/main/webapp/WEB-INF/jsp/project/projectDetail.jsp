<%@ page language="java" pageEncoding="UTF-8"%><%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%><%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%><c:set var="ctx" value="${pageContext.request.contextPath }" scope="request"></c:set><%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%><link href="${ctx }/css/base.css" rel="stylesheet" /><link href="${ctx }/css/payoff.css" rel="stylesheet" /><link rel="stylesheet" type="text/css" href="${ctx }/css/global.min.css" /><link rel="stylesheet" type="text/css" href="${ctx }/css/global_projects.min.css"/><link href="${ctx }/css/ec_alerts_new.css" rel="stylesheet" /><script type="text/javascript" src="${ctx }/js/ec_alert_new.js"></script><script type="text/javascript">$(document).ready(function(){	$(".btn-slide").click(function(){		$("#panel").slideToggle("slow");		$(this).toggleClass("active"); return false;	}); 		$("#userReg").click(function(){					$("#panel").slideToggle("slow");		$(this).toggleClass("active"); return false;		});	});</script><script type="text/javascript">	$(function() {				// 回报图片切换		$(".pindex_return_con .con .con_text p").hover(						function() {							if ($(this).attr("name") != 'http://s.dreamore.com/Uploads/Project/Support/') {								$(this).parent().parent().prev().find("img")										.attr('src', $(this).attr("name"));							}						});		var lisize = $(".pindex_return_top ul li").size();		$(".pindex_return_top ul li").css('width', ((1023 / lisize) - 1));		var pic_listsize = $(".pindex_return_con_on .pic .pic_lists ul li")				.size();		$(".pindex_return_con_on .pic .pic_lists ul").css('width',				pic_listsize * 320);		$(".pindex_return_con_on .pic .pic_show img").attr(				'src',				$(".pindex_return_con_on .pic .pic_lists ul li:first img")						.attr('src'));		$(".pindex_return_top ul li")				.hover(						function() {							$("#projectInvestId").val($(this).attr('name'));							$(".pindex_return_top ul li").removeClass('on');							$(".pindex_return_con").removeClass(									'pindex_return_con_on');							$(									".pindex_return_con_"											+ $(this).attr('name') + ':first')									.addClass('pindex_return_con_on');							$(this).addClass('on');							 $("#targetsupportNum").val(1);							 $(".pindex_return_con_on .intro .intro_li .r .count").val(1);						});						$(".intro_li .r span.count_do").click(						function() {							var count = parseInt($(									".pindex_return_con_on .intro .intro_li .r .count")									.val());							var count_x = parseInt($(									".pindex_return_con_on .intro .intro_li .r span.x")									.text());							var count_y = parseInt($(									".pindex_return_con_on .intro .intro_li .r span.y")									.text());							if ($(this).hasClass('count_do_jian')) {								if (count > 1) {									var num =parseInt($(".pindex_return_con_on .intro .intro_li .r .count").val());									$(".pindex_return_con_on .intro .intro_li .r .count").val(num- 1);								    $("#targetsupportNum").val(num-1);								}															}							if ($(this).hasClass('count_do_jia')) {								if (count < count_x - count_y) {									var num=parseInt($(".pindex_return_con_on .intro .intro_li .r .count").val());									$(".pindex_return_con_on .intro .intro_li .r .count").val(num + 1);									 $("#targetsupportNum").val(num+1);								}else{									top.jQuery.alerts.alert('已经超过该套餐最大支持数');								}							}						});		$(".pindex_con_discuss .add ul li span.s").click(				function() {					if (!$(this).hasClass('on')) {						$(this).parent().find('span.s').removeClass('on');						$(this).parent().find('input[name=type]').val(								$(this).attr('data-id'));						$(this).addClass('on');					}				});		// 支持处理		$("#support").click(function() {			$(".pop_pay").show();			$(".pop_pay").animate({				top : (($(window).height() - $(".pop_pay").height()) / 2)			}, 500);		});		$("#close").click(function() {			$(".pop_pay").animate({				top : (-1000)			}, 500);		});	});		function support(){		var projectInvestid = $("#projectInvestId").val();		var count = $("#targetsupportNum").val();				$.post("${ctx}/"+projectInvestid+"/"+count+"/getProjectInfo", {}, function(data) {			if(data.resCode == 0){				top.jQuery.alerts.alert(data.resMsg);				return false;			}else{				$("#hb").html(data.resMsg.name);				$("#price").html(data.resMsg.price);				$("#count").html(data.resMsg.count);				$("#realAmount").html(data.resMsg.realAmount);				$("#ye").html(data.resMsg.userWalletAmount);				$(".pop_pay").show();				$(".pop_pay").animate({					top : (($(window).height() - $(".pop_pay").height()) / 2)				}, 500);			}					});					}	// 加关注	function follow(project_id) {		$.get('/projects/follow', {			'project_id' : project_id		}, function(data) {			re = data;			if (re.status == 1) {				$('a.btn_follow').text(re.data);			}			alert(re.info);		});	}		function pay(){		var projectInvestid = $("#projectInvestId").val();		var count = $("#targetsupportNum").val();		var remark = $("#remark").val();				$.post("${ctx}/"+projectInvestid+"/"+count+"/payForProject", {remark:remark}, function(data) {			if(data.resCode == 0){				top.jQuery.alerts.alert(data.resMsg);			}else{				top.jQuery.alerts.alert("支付成功！");				window.location.href = "${ctx}/user/project/manager";			}		});	}</script><div class="pindex_top">  <div class="w_content">    <div class="pindex_top_title">      <h5> <span class="left">${project.name }</span> </h5>      <div class="pindex_top_follow"><!--   <a class="btn_zf">转发也是支持</a><a class="btn_follow">加关注</a> <a class="btn_follow" style="display:none;">取消关注</a>-->            <!-- Baidu Button BEGIN --><div id="bdshare" class="bdshare_t bds_tools_32 get-codes-bdshare" data="{'url':http://www.wowpower.cn/${project.id }/projectDetail.html,'text':${project.name }}"><a class="bds_qzone"></a><a class="bds_tsina"></a><a class="bds_tqq"></a><a class="bds_renren"></a><a class="bds_t163"></a><span class="bds_more"></span></div><script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=0" ></script><script type="text/javascript" id="bdshell_js"></script><script type="text/javascript">document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)</script><!-- Baidu Button END -->            </div>      <div class="clear"></div>    </div>    <div class="pindex_top_total clear">      <div class="l left">${project.nameDesc }</div>      <div class="r right">        <div class="li"> <span id="refresh_endtime" class="num">${project.endDays }</span> <span class="num_desc">天/剩余</span> </div>        <div class="li"> <span id="refresh_speed" class="num">${project.scale }%</span> <span class="num_desc">进度</span> </div>        <div class="li"> <span id="refresh_people" class="num">${project.persons }</span> <span class="num_desc">次/支持</span> </div>        <div class="li"> <span id="refresh_money" class="num">¥${project.sumAmount }</span> <span class="num_desc">已筹款</span> </div>        <div class="li"> <span class="num">¥${project.goalMoney }</span> <span class="num_desc">目标金额</span> </div>      </div>      <div class="clear"></div>    </div>    <div id="project_support" class="pindex_return">      <div class="pindex_return_top">               <c:forEach items="${projectInvests}" var="projectInvest" varStatus="status">         <c:choose>               <c:when test="${status.first==true}">       <ul>                 <li class="on" name="${projectInvest.id}" style="width: 145.143px;">¥ ${projectInvest.amount}</li>                 <input type="hidden" id="projectInvestId" size="30" value="${projectInvest.id}"/>                 <input type="hidden" id="targetsupportNum" size="30" value="1"/>                              </c:when>             <c:otherwise>                  <li class="" name="${projectInvest.id}" style="width: 145.143px;">¥ ${projectInvest.amount}</li>             </c:otherwise>         </c:choose>              </c:forEach>          <div class="clear"></div>        </ul>      </div>       <c:forEach items="${projectInvests}" var="projectInvest" varStatus="status">       <c:choose>               <c:when test="${status.first==true}">                  <div class="pindex_return_con pindex_return_con_${projectInvest.id} pindex_payoff_8386 pindex_return_con_on">             </c:when>             <c:otherwise>                   <div class="pindex_return_con pindex_return_con_${projectInvest.id} pindex_payoff_8386 ">             </c:otherwise>       </c:choose>        <div class="pic left">         <c:choose>		<c:when test="${ not empty projectInvest }">			  <img width="320" height="240" alt="回报图片描述" src="${ctx }/${projectInvest.id }/getAdvertiseImg"  onerror="this.src='${ctx }/images/zcpt/zc1.jpg'" > <b class="fi"></b>		</c:when>	  </c:choose>	       </div>        <div class="con left">          <div class="con_title">支持后您将获得</div>          <div class="con_text">						<c:choose>							<c:when								test="${projectInvest.content eq '' or projectInvest.content eq null}">								<p> 									筹集成功的定义:项目进度达到100%。 <br>									筹集成功每份您将获得${projectInvest.benefit_amount}纳币返利；<br>									筹集失败每份您将获得${projectInvest.miss_benefit_amount}纳币返利；</p>							</c:when>							<c:otherwise>								<p>${projectInvest.content}</p>							</c:otherwise>						</c:choose>          </div>        </div>        <div class="intro left">          <div class="intro_li">            <div class="l left">支持金额</div>            <div class="r left"> <span class="money">${projectInvest.amount}</span> 元 </div>            <div class="clear"></div>          </div>          <div class="intro_li">            <div class="l left">限量支持</div>            <div class="r left"> <span class="money_12 x">${projectInvest.support_num}</span> 次    已支持 <span class="money_12 y">${projectInvest.already_support_num}</span> 次 </div>            <div class="clear"></div>          </div>                  <div class="intro_li pakeage">            <div class="l left">回报套餐</div>            <div class="r left">              <c:choose>				<c:when test="${ not empty projectInvest.invest_name }">				   <span class="style left checked" >${projectInvest.invest_name} </span> 				</c:when>				<c:otherwise>				   <span class="style left checked" >回报套餐 </span> 				</c:otherwise>			 </c:choose>                         </div>            <div class="clear"></div>          </div>          <div class="intro_li" style="margin-bottom:20px; *margin-bottom: 15px;">            <div class="l left">支持数量</div>            <div class="r left"> <span class="count_do count_do_jian left" title="减一件">-</span>              <input class="count left" type="text" readonly="readonly" value="1">              <span class="count_do count_do_jia left" title="加一件">+</span> 件 </div>            <div class="clear"></div>          </div>          <div class="intro_li" style="margin-bottom:0;">            <div class="l left"> </div>            <sec:authorize access="isAuthenticated()">					<div class="r left" > <a class="btn_blue" onclick="support()" >我要支持</a> </div>			</sec:authorize>			<sec:authentication property="principal" var="currentUsr" scope="page"/>						 <c:if test="${currentUsr eq '' or currentUsr eq null or currentUsr eq 'anonymousUser'}">						    <div class="r left" ><a class="btn_dack" href="${ctx }/user/account/manager.html?target=${ctx}/${projectInvest.project_id}/projectDetail.html">登录后支持</a> </div>						 </c:if>            <div class="clear"></div>          </div>          <div class="clear"></div>        </div>      </div>      </c:forEach>      <div class="clear"></div>              </div>  </div></div><div class="pindex_content"><div class="pindex"><div class="pindex_con">  <div class="pindex_con_content"> ${project.projectDesc }  </div>  <div id="SOHUCS"></div><script>  (function(){    var appid = 'cyqR7pP82',    conf = 'prod_9854d7afce413aa13cd0a1d39d0bcec5';    var doc = document,    s = doc.createElement('script'),    h = doc.getElementsByTagName('head')[0] || doc.head || doc.documentElement;    s.type = 'text/javascript';    s.charset = 'utf-8';    s.src =  'http://assets.changyan.sohu.com/upload/changyan.js?conf='+ conf +'&appid=' + appid;    h.insertBefore(s,h.firstChild);  })()</script></div><div class="pindex_side"><div class="pindex_side_admin pindex_side_pj">  <div class="author">    <div class="author_face left"><img width="120" height="120" alt="蛙宝网" src="${ctx }/images/zcpt/tx03.jpg"></div>    <div class="author_side right">      <h5> 蛙宝网 <i class="attestation" title="身份信息已通过实名认证"></i> </h5>      <p> <span class="l">性别</span> <span class="r">女</span> </p>      <p> <span class="l">积分</span> <span class="r">888</span> </p>      <p> <span class="l">操作</span> <span class="r"> Coming Soon </span> </p>    </div>  </div>  <div class="author_info">    <p> <span> <span class="l">发起地点</span> <span class="r">${project.addr }</span> </span> </p>    <p> <span> <span class="l">回报执行</span> <span class="r">承诺项目筹集成功之后根据每份的套餐执行返利</span> </span> </p>    <p> <span> <span class="l">结束时间</span> <span class="r"><fmt:formatDate value="${project.daysDate }" pattern="yyyy-MM-dd HH:mm"/></span> </span> </p>    <p> <span> <span class="l">个人网址</span> <span class="r">http://www.wowpower.cn </span> </span> </p>    <p> <span> <span class="l">自我简介</span> <span class="r">网络金融理财新选择。我们承诺做到更透明、更高效、更安全。</span> </span> </p>  </div></div><div class="pindex_side_model pindex_side_pj">  <h2>筹款说明</h2>  <p>${project.explanation }</p></div><div class="pindex_side_pj pindex_side_supporter"><h2> 这些人已经支持了 <span> <a name="12166"  class="ck_all fr"></a> </span> </h2><div class="ul">  <ul id="refresh_supporters">  <c:forEach items="${userList }" var="item">    <li>      <div class="count text_c">￥${item.sumAmount }</div>      <a href="javascript:void(0)"> <img class="uface" width="68" height="68" src="${ctx }/${item.userId }/getPhoto"  onerror="this.src='${ctx }/images/zcpt/zc1.jpg'"  > <b class="fi"></b> </a>      <p>${item.nickName }</p>      <p><fmt:formatDate value="${item.lastTime }" pattern="MM-dd HH:mm"/></p>    </li>    </c:forEach>      <div class="clear"></div>  </ul></div></div><div class="pindex_side_pjs pindex_side_pj">  <h2>您可能感兴趣的项目</h2>  <div class="plists" style="width:289px;padding:0 0 0 30px;">    <ul>    <c:forEach items="${randList }" var="item">      <li class="brd_4">        <div class="plists_status status_3 brd_0400"></div>        <div class="plists_thumb"><a target="_blank" href="${ctx }/${item.id }/projectDetail.html"><img class="lazy brd_4" width="220" height="150" title="${item.name }" alt="${item.name }"  src="${ctx }/showProjectPic?id=${item.id}"  onerror="this.src='${ctx }/images/zcpt/zc1.jpg'" style="display: inline;"></a></div>        <div class="plists_middle">          <div class="plists_title"><a target="_blank" href="#">${item.name }</a></div>          <div class="plists_summarys">${item.nameDesc }</div>          <div class="plists_author">            <div class="from"><i></i>${item.addr }</div>            <div class="name"><a  href="javascript:void(0)">蛙宝网</a></div>          </div>        </div>        <div class="plists_bottom">          <div class="plists_speed" title="当前项目进度为${item.scale }%">            <div class="plists_speed_bg" style="width:${item.scale }%"></div>          </div>          <div class="plists_total">            <div class="plists_total_money" title="当前已筹集${item.sumAmount }元资金"><em class="money"></em>${item.sumAmount }</div>            <div class="plists_total_people" title="当前已有${item.persons }次支持"><em class="people"></em>${item.persons }</div>            <div class="plists_total_time" title="离项目结束仅剩${item.endDays }天"><em class="time"></em>${item.endDays }</div>            <div class="clear"></div>          </div>        </div>      </li>      </c:forEach>    </ul>  </div></div></div></div></div>